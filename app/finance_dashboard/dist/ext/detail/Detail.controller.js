sap.ui.define(["sap/fe/core/PageController","sap/m/MessageBox"],function(e,t){"use strict";const{ajax:n}=$;let o,r,a,c;return e.extend("financedashboard.ext.main.Main",{onInit:function(){o=new sap.ui.model.json.JSONModel({editable:true,financeApprove:true,financeComments:""});this.getAppComponent().getRouter(this).getRoute("TravelRequestDetail").attachPatternMatched(this._onDetailMatched,this);r=this.getView();r.setModel(o,"localModel");c=this.getAppComponent().getModel().getServiceUrl()},onEmail:function(e){window.open("mailto:"+e.getSource().getText())},onShare:function(){const e=window.location.href,t="Check out this Travel Plan!",n="Hi,\n\nI found this interesting travel plan. Check it out: "+e,o=document.createElement("a"),r="mailto:?subject="+encodeURIComponent(t)+"&body="+encodeURIComponent(n);o.href=r;o.click()},_onDetailMatched:function(e){a=e.getParameter("arguments").ID;const t=r.byId("idObjectPageLayout");r.setBusy(true);t.bindElement("/TravelRequest("+a+")");setTimeout(function(){r.setBusy(false)},1e3);n({method:"GET",url:c+`TravelRequest(${a})/financenotes/$value`,success:function(e){o.setProperty("/financeComments",e||"")},error:console.error})},onApproveReject:function(e){const{financeComments:a}=o.getData(),i=e.getSource().getText()==="Approve",{REQID:s,emailid:u,firstname:d,empid:p}=r.byId("idObjectPageLayout").getBindingContext().getObject();if(!a){t.error("Please add finance comments");return}t.confirm(`Are you sure you want to ${i?"approve":"reject"} this travel request?`,{onClose:function(e){if(e===t.Action.OK){n({method:"POST",url:c+"updateRequest",headers:{"Content-Type":"application/json"},data:JSON.stringify({REQID:s,reqstatus:i?"ApprovedF":"RejectedF",financenotes:a,emailid:u,firstname:d,empid:p}),success:function(){t.success("State Updated",{onClose:function(){window.history.go(-1)}})},error:console.error})}}.bind(this)})},_onFormatState:function(e){if(!e){return}switch(e){case"ApprovedF":case"ApprovedM":return"Success";case"RejectedF":case"RejectedM":return"Error";case"Completed":return"Success";default:return"Warning"}},_onFormatStateIcon:function(e){if(!e){return}switch(e){case"ApprovedF":case"ApprovedM":return"sap-icon://accept";case"RejectedF":case"RejectedM":return"sap-icon://error";case"Completed":return"sap-icon://completed";default:return"sap-icon://pending"}},_onFormatStateText:function(e){if(!e){return}switch(e){case"ApprovedF":case"ApprovedM":return"Approved";case"RejectedF":case"RejectedM":return"Rejected";case"Completed":return"Completed";default:return"Pending"}},_onGetDaysLeftFromToday:function(e){if(!e){return"0"}const t=new Date;const n=(-t.getTime()+new Date(e).getTime())/(1e3*60*60*24);return Math.ceil(n)}})});
//# sourceMappingURL=Detail.controller.js.map